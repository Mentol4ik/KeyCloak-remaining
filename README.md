# KeyCloak-remaining
  Этот скрипт предназначен для автоматизации процесса парсинга Excel-файла с данными пользователей, обновления паролей для пользователей в Keycloak и отправки уведомлений пользователям с их новыми паролями. Ниже приведено подробное описание компонентов и функционала скрипта.

## Компоненты
### Imports
  Скрипт импортирует несколько модулей и библиотек для выполнения различных задач:

+ smtplib, email.mime.multipart, email.mime.text, email.mime.base, email.encoders: **для отправки писем.**

+ urllib, os, sys, string: **для системных операций.**

+ pandas as pd, openpyxl as xl: **для работы с Excel-файлами.**

+ requests: **для выполнения HTTP-запросов.**

+ platform: **для получения версии Python.**

+ KeycloakAdmin: **для взаимодействия с сервером Keycloak.**

### Класс Task
  Класс Task представляет собой задачу пользователя. Он содержит следующие атрибуты:

+ user_id: **ID пользователя.**

+ uuid: **Уникальный идентификатор пользователя в Keycloak.**

+ name: **Имя пользователя.**

+ email: **Электронная почта пользователя.**

+ login: **Логин пользователя.**

+ new_pass: **Новый пароль пользователя.**

+ status: **Статус задачи (0: ожидается, 1: успех, 2: ошибка в Keycloak, 3: ошибка в уведомлении).**

### Функции
+ **parse_xls_file(file_name)**

  Эта функция парсит Excel-файл и возвращает список объектов Task. Excel-файл должен содержать следующие столбцы: "ID", "Name", "Email", "New_password" и "Login".

+ **sending()**

  Эта закомментированная функция предназначена для отправки email-уведомлений. Она использует smtplib для подключения к SMTP-серверу и отправки писем. Сервер, пользователь, пароль, получатели, отправитель, тема и текст письма заданы в коде.

+ **resset_password(task)**

  Эта функция сбрасывает пароль пользователя в Keycloak. Она использует класс KeycloakAdmin для взаимодействия с сервером Keycloak и установки нового пароля для пользователя.

+ **send_notify_to_user(task)**

  Эта функция отправляет уведомление пользователю. В данный момент она только выводит сообщение о том, что уведомление отправлено.

### Основная функция
Основная функция main организует весь процесс:

Определяет имя Excel-файла.

Парсит Excel-файл для создания списка объектов Task.

Перебирает список задач (исключая первую) и выполняет следующие шаги для каждой задачи:

Сбрасывает пароль пользователя в Keycloak.

Отправляет уведомление пользователю.

Выводит детали задачи и сообщение "Running ends successfully".
